<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Mapa Interativo ‚Äì Sergipe</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

<!-- LEAFLET -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
/* ================= BASE ================= */
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

#map {
  height: 100%;
  width: 100%;
}

/* ================= HEADER ================= */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  padding: 10px 14px;
  background: linear-gradient(135deg, #0b3c5d, #1a5276);
  color: white;
  z-index: 1000;
}

.header h1 {
  font-size: 16px;
  margin: 0;
}

.header p {
  font-size: 11px;
  margin: 2px 0 0;
  opacity: .9;
}

/* ================= SEARCH ================= */
.search-bar {
  position: fixed;
  top: 60px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 6px;
  z-index: 1000;
  background: rgba(255,255,255,0.96);
  padding: 6px;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,.2);
}

.search-bar input {
  width: 120px;
  padding: 6px;
  font-size: 13px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

.search-bar button {
  padding: 6px 10px;
  font-size: 14px;
  border: none;
  border-radius: 6px;
  background: #0b3c5d;
  color: white;
}

/* ================= CONTROLS ================= */
.floating-controls {
  position: fixed;
  right: 10px;
  bottom: 20px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 1000;
}

.control-btn {
  width: 44px;
  height: 44px;
  border-radius: 50%;
  border: none;
  background: white;
  box-shadow: 0 3px 10px rgba(0,0,0,.3);
  font-size: 18px;
}

/* ================= INFO PANEL ================= */
.info-panel {
  position: fixed;
  left: 10px;
  bottom: 20px;
  background: rgba(255,255,255,.96);
  padding: 12px;
  border-radius: 10px;
  font-size: 12px;
  box-shadow: 0 3px 10px rgba(0,0,0,.3);
  z-index: 1000;
}

/* ================= TOAST ================= */
.toast {
  position: fixed;
  top: 120px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(40,40,40,.95);
  color: white;
  padding: 10px 18px;
  border-radius: 8px;
  font-size: 13px;
  display: none;
  z-index: 2000;
}

/* ================= MOBILE ================= */
@media (max-width: 600px) {
  .info-panel {
    display: none;
  }

  .search-bar input {
    width: 100px;
  }
}
</style>
</head>

<body>

<div class="header">
  <h1>üó∫Ô∏è Mapa Interativo ‚Äì Sergipe</h1>
  <p>Pesquisa por Latitude e Longitude</p>
</div>

<div class="search-bar">
  <input id="latInput" placeholder="Latitude">
  <input id="lngInput" placeholder="Longitude">
  <button onclick="searchByLatLng()">üîç</button>
</div>

<div id="map"></div>

<div class="floating-controls">
  <button class="control-btn" onclick="resetView()">üéØ</button>
  <button class="control-btn" onclick="toggleLayer()">üõ∞Ô∏è</button>
  <button class="control-btn" onclick="clearMarkers()">üóëÔ∏è</button>
</div>

<div class="info-panel">
  <div><strong>Marcadores:</strong> <span id="count">0</span></div>
  <div><strong>Zoom:</strong> <span id="zoom">8</span></div>
</div>

<div class="toast" id="toast"></div>

<script>
/* ================= CONFIG ================= */
const CONFIG = {
  center: [-10.5746, -37.3857],
  zoom: 8,
  bounds: [[-11.55,-38.30],[-9.60,-36.38]],
  municipios: {
    Aracaju: [-10.9472,-37.0731],
    Itabaiana: [-10.685,-37.425],
    Lagarto: [-10.9136,-37.6689]
  }
};

let map, street, satellite;
let markers = [];
let layer = "street";

/* ================= INIT ================= */
map = L.map("map", { maxBounds: CONFIG.bounds })
  .setView(CONFIG.center, CONFIG.zoom);

street = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");
satellite = L.tileLayer(
 "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"
);

street.addTo(map);

/* ================= EVENTS ================= */
map.on("zoomend moveend", () => {
  document.getElementById("zoom").innerText = map.getZoom();
});

/* ================= FUNCTIONS ================= */
function toggleLayer() {
  if (layer === "street") {
    map.removeLayer(street);
    satellite.addTo(map);
    layer = "satellite";
  } else {
    map.removeLayer(satellite);
    street.addTo(map);
    layer = "street";
  }
}

function searchByLatLng() {
  const lat = parseFloat(latInput.value);
  const lng = parseFloat(lngInput.value);

  if (isNaN(lat) || isNaN(lng)) {
    toast("‚ùå Coordenadas inv√°lidas");
    return;
  }

  if (lat < CONFIG.bounds[0][0] || lat > CONFIG.bounds[1][0]) {
    toast("‚ùå Fora de Sergipe");
    return;
  }

  const marker = L.circleMarker([lat,lng], {
    radius: 8,
    color: "#fff",
    fillColor: "#e74c3c",
    fillOpacity: .9
  }).addTo(map);

  markers.push(marker);
  map.setView([lat,lng], 14);
  updateCount();
  toast("üìç Ponto localizado");
}

function clearMarkers() {
  markers.forEach(m => map.removeLayer(m));
  markers = [];
  updateCount();
}

function resetView() {
  map.setView(CONFIG.center, CONFIG.zoom);
}

function updateCount() {
  document.getElementById("count").innerText = markers.length;
}

function toast(msg) {
  const t = document.getElementById("toast");
  t.innerText = msg;
  t.style.display = "block";
  setTimeout(()=>t.style.display="none", 2500);
}
</script>

</body>
</html>
